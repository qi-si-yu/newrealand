TNZ=window.TNZ||{},TNZ.AsyncContentBlock=function(a,e,s){if((a=a||{placement_id:-1,endpoint:""}).placementtype=a.placementtype||"insert",a.queryParams=e||{},a.loadoninit=!(null!=a.loadoninit&&!a.loadoninit),!1==!!a.placement_id||-1===a.placement_id)throw new Error('Settings param "placement_id" is required.');if(!1==!!a.endpoint||0===a.endpoint.length)throw new Error('Settings param "endpoint" is required and needs a value.');a.successCallBack=a.successCallBack||function(){},a.errorCallBack=a.errorCallBack||function(){},a.cache=!(null!=a.cache&&!a.cache),s=s||jQuery;var r=this,o={headTag:document.getElementsByTagName("head")[0],lastCSSFile:"css/utilities.css",cssBackupOrderFinder:[{key:"vendors",value:"shared.css"},{key:"units",value:"vendors"},{key:"components",value:"units"}]},t={};r.attachHTML=function(e){var t=s("#"+a.placement_id);"replace"===a.placementtype?t.replaceWith(e):t.append(e)},r.attachStyleInline=function(e){var t=s("#"+a.placement_id),n=r.createElement(e,"style");t.append(n)},r.attachCSS=function(e){for(var t=s(o.headTag),n=TNZ.Util.getAddedCSSFilesArray(),l=0;l<e.length;l++)if(-1===n.indexOf(e[l])){TNZ.Util.trackAddedCSSFiles(e[l]);var a=r.getAttachCSSPosition(e[l]);a?s(a).after("<link rel='stylesheet' href='"+e[l]+"' type='text/css' media='all' as='style' />"):t.append("<link rel='stylesheet' href='"+e[l]+"' type='text/css' media='all' as='style' />")}},r.getAttachCSSPosition=function(e){var t=e.split("/"),n=t.slice(0,-1),l=n.slice(-1).pop(),a=t.slice(0,-1).join("/"),i=document.querySelectorAll('link[as="style"][href*="'+a+'/"]');return i=!0==!!i&&0<i.length?i[i.length-1]:r.getLastValidCSSAttachPosition(l,n.slice(0,-1))},r.getLastValidCSSAttachPosition=function(e,t){for(var n=!1,l=null,a=null,i=o.cssBackupOrderFinder.length-1;0<=i;i--)if(o.cssBackupOrderFinder[i].key==e){var r=JSON.parse(JSON.stringify(t));r.push(o.cssBackupOrderFinder[i].value);var c=r.join("/");if(!0==!!(l=document.querySelectorAll('link[as="style"][href*="'+c+'"]'))&&0<l.length){l=l[l.length-1],n=!0,a=s(l);break}}return!1===n&&(l=document.querySelectorAll('link[as="style"][href*="'+o.lastCSSFile+'"]')[0],a=s(l).prev()),a[0]?a[0]:null},r.attachJsInline=function(e){var t=r.createElement(e,"script");o.headTag.insertBefore(t,null)},r.loadJSFiles=function(e){for(var t=0;t<e.length;t++){var n=e[t].aDependentEvents||[];TNZ.JSLib.loadScript(e[t].src,e[t].event,n)}},r.createElement=function(e,t){var n=document.createElement(t);return"string"==typeof e&&(n.innerHTML=e.trim()),n},t.setEndpoint=function(e){a.endpoint=e},t.loadContentBlock=function(e,t){var n=a.endpoint;t&&(n=t);var l=e;s.ajax({url:n,dataType:"json",type:"GET",data:l,cache:a.cache,success:function(e){e.css&&e.css.length&&r.attachCSS(e.css),e.style&&e.style.length&&r.attachStyleInline(e.style),e.html&&e.html.length&&r.attachHTML(e.html),e.jsinline&&e.jsinline.length&&r.attachJsInline(e.jsinline),e.js&&e.js.length&&r.loadJSFiles(e.js),a.successCallBack(e)},error:function(e){console.log("Load content block ERROR",e),a.errorCallBack(e)}})};return-1===a.placement_id?console.log("Error- No placement ID given to insert content into"):a.loadoninit&&t.loadContentBlock(a.queryParams),t};