TNZ=window.TNZ||{},TNZ.Carousel=function(t,n){if(t=t||{auto_play_video:!1},n=n||jQuery,!1==!!t.block_unique_id)throw new Error('Settings param "block_unique_id" is required.');if(null==t.ismulti||typeof t.ismulti==typeof!0==!1)throw new Error('Settings param "ismulti" is required and must be true|false (boolean value). \nThis sets the performance marker for a single or multi item carousel,\nand sets the carousel to be milti or single asset.');null!=t.auto_play_video&&typeof t.auto_play_video==typeof!0!=!1||(t.auto_play_video=!1),t.performanceTrackingMarker=t.ismulti?"carousel_multiple_libs_loaded":"carousel_single_libs_loaded",TNZ.performance.mark(t.performanceTrackingMarker);var a={isVideoPlaying:!1,playButtonClicked:!1,videoAutoPlayable:null,videosThatAutoPlayed:[]},o={},l=n("#"+t.block_unique_id);a.slider=".js-swiper",a.slider_prev=".js-swiper-prev",a.slider_next=".js-swiper-next",a.slider_pagination=".js-swiper-pagination",a.slider_fraction_class="o-slider__pagination--fraction",a.autoplay_pause_class=".js-slider-pause",a.autoplay_resume_class=".js-slider-resume",a.video_close_class=".js-player-close",o.getData=function(){return a},o.getSettings=function(){return t},o.initSwiper=function(){o.destroy();var e=l.find(a.slider);t.ismulti&&0<e.length?i(e):s()},o.update=function(){a.swipeObject.update(!0)},o.destroy=function(){a.swipeObject&&(a.swipeObject.destroy(!0,!0),delete a.swipeObject)};var i=function(e){if(a.isVideoPlaying=!1,swiper_options={autoplay:{delay:5e3,disableOnInteraction:!1},threshold:30,loop:!0,autoHeight:!0,navigation:{nextEl:l.find(a.slider_next),prevEl:l.find(a.slider_prev)},on:{init:function(){s()},slideChangeTransitionStart:function(){r(),a.isVideoPlaying&&TNZ.EventManager.trigger("TNZ.VideoPlayer.Stop",{block_unique_id:t.block_unique_id}),a.swipeObject&&u(a.swipeObject.slides[a.swipeObject.activeIndex])},beforeDestroy:function(){o.removeEvents(),a.swipeObject&&a.swipeObject.detachEvents()}}},l.find(a.slider_pagination).length){var i="bullet";l.find(a.slider_pagination).hasClass(a.slider_fraction_class)&&(i="fraction"),swiper_options.pagination={el:l.find(a.slider_pagination),type:i}}a.swipeObject=new Swiper(e,swiper_options),l.find(a.autoplay_pause_class).on("click",function(){a.swipeObject&&a.swipeObject.autoplay&&(a.swipeObject.autoplay.stop(),a.isVideoPlaying=!0)}),l.find(a.autoplay_resume_class).on("click",function(){a.swipeObject&&a.swipeObject.autoplay&&(a.swipeObject.autoplay.start(),a.isVideoPlaying=!1)}),l.find(a.slider).on("mouseenter",function(){a.swipeObject&&a.swipeObject.autoplay&&a.swipeObject.autoplay.stop()}).on("mouseleave",function(){a.swipeObject&&a.swipeObject.autoplay&&(a.isVideoPlaying||a.swipeObject.autoplay.start())}),TNZ.JSLib.requireLoadEvent(["/thirdparty/hammer/hammer.min.js"],function(e){if(e[0]){var i=e[0],t=new Hammer(i),n=e.data("renderertype")||"unknown";t.on("swipe",function(e){try{TNZ.DTM.setVar("renderertype",n),TNZ.DTM.track("block-carousel-navigation-swipe")}catch(e){}TNZ.EventManager.trigger("tnz.carousel.swipe",{slideshow:i})})}},e)};o.removeEvents=function(){l.find(a.autoplay_pause_class).off("click"),l.find(a.autoplay_resume_class).off("click"),l.find(a.slider).off("hover")};var r=function(){var e=a.swipeObject?a.swipeObject.previousIndex:1;try{TNZ.DTM.setVar("carouselItemIndex",e.toString())}catch(e){}},s=function(){setTimeout(function(){t.auto_play_video&&TNZ.EventManager.trigger("TNZ.VideoPlayer.Play-"+t.block_unique_id,{block_unique_id:t.block_unique_id}),TNZ.EventManager.trigger("tnz.carousel.ready-"+t.block_unique_id,{block_unique_id:t.block_unique_id}),TNZ.EventManager.trigger("tnz.carousel.ready",{block_unique_id:t.block_unique_id}),TNZ.JSLib.triggerLoadEvent("tnz.carousel.ready-"+t.block_unique_id,{block_unique_id:t.block_unique_id}),TNZ.JSLib.triggerLoadEvent("tnz.carousel.ready",{block_unique_id:t.block_unique_id})},300)},u=function(e){var i=e.querySelectorAll('img[style*="display:none"]');if(0===i.length&&(i=e.querySelectorAll('img[style*="display: none"]')),0===i.length&&(i=e.querySelectorAll('img[style="display: none;"]')),i.length){for(var t=0;t<i.length;t++)i[t].setAttribute("style","display:block");o.update()}};return function(){setTimeout(function(){o.initSwiper()},500),a.resizestarted=!1;var e=n(window).width();n(window).on("resize",function(){n(window).width()!=e&&t.ismulti&&(e=n(window).width(),!1===a.resizestarted&&(a.resizestarted=!0,o.destroy()),a.resizestarted=!0)}),TNZ.EventManager.bind("TNZ.Resize.End",function(){!1==!!a.swipeObject&&t.ismulti&&setTimeout(function(){o.initSwiper(),a.resizestarted=!1},700)}),TNZ.EventManager.bind("tnz.carousel.hidetitle-"+t.block_unique_id,function(e){var i=n("#"+t.block_unique_id).find(".js-carousel-title");i.length&&i.addClass("u-visually-hidden@desktop+")}),TNZ.EventManager.bind("tnz.carousel.showtitle-"+t.block_unique_id,function(e){var i=n("#"+t.block_unique_id).find(".js-carousel-title");i.length&&i.removeClass("u-visually-hidden@desktop+")}),TNZ.EventManager.bind("TNZ.VideoPlayer.PlayButtonClicked-"+t.block_unique_id,function(e){a.playButtonClicked=!0}),TNZ.EventManager.bind("TNZ.VideoPlayer.PlayerReady-"+t.block_unique_id,function(e){a.playButtonClicked=!1}),TNZ.EventManager.bind("TNZ.VideoPlayer.YouTubePlayerStateChange-"+t.block_unique_id,function(e){!0===e.settings.auto_play&&YT&&e.event.data===YT.PlayerState.UNSTARTED&&(a.videoAutoPlayable=!1),null===a.videoAutoPlayable&&!0===e.settings.auto_play&&YT&&e.event.data===YT.PlayerState.PLAYING&&!1===a.playButtonClicked&&!1===function(e){return-1!=a.videosThatAutoPlayed.indexOf(e)}(e.videoData.videoId)&&(function(e){e.hasOwnProperty("videoId")&&TNZ.DTM.setVar("block_carousel_element_videoid",e.videoId.toString()),e.hasOwnProperty("videoProvider")&&TNZ.DTM.setVar("block_carousel_element_videoprovider",e.videoProvider.toString())}(e.videoData),TNZ.DTM.track("block-carousel-video-autoplay"),a.videosThatAutoPlayed.push(e.videoData.videoId)),a.playButtonClicked=!1}),TNZ.EventManager.bind("TNZ.VideoPlayer.YouKuPlayerStateChange-"+t.block_unique_id,function(e){a.playButtonClicked=!1}),TNZ.EventManager.bind("TNZ.VideoPlayer.YouKuPlayerStateChange-"+t.modal_block_unique_id,function(e){TNZ.EventManager.trigger("TNZ.VideoPlayer.YouKuPlayerStateChange-"+t.block_unique_id,e)});var i=TNZ.Util.debounce(function(){a.swipeObject.updateAutoHeight()},500);TNZ.EventManager.bind("TNZ.TravelDeal.Loaded-"+t.block_unique_id,function(e){a.swipeObject&&TNZ.Device.isMobile()&&e.hasOwnProperty("bHasDeal")&&e.bHasDeal&&i()})}(),o};