TNZ=window.TNZ||{},TNZ.GeoLocation=function(){function t(){var e={success:!0};null!=TNZ.Cookie.get("override_X-latitude")?(e.highFidelity=!0,e.latitude=TNZ.Cookie.get("override_X-latitude"),e.longitude=TNZ.Cookie.get("override_X-longitude")):(e.highFidelity=r.highFidelity,e.latitude=r.latitude,e.longitude=r.longitude),TNZ.JSLib.triggerLoadEvent(r.sharingEvent,e)}function n(e){try{TNZ.DTM.track("shareLocationTrueTrigger")}catch(e){}o.setCurrentPosition(e.coords,!0),r.fetchInProgress&&(r.fetchInProgress=!1,t())}function i(){try{TNZ.DTM.track("shareLocationFalseTrigger")}catch(e){}TNZ.JSLib.triggerLoadEvent(r.sharingEvent,{success:!1})}var o={},r={};return o.init=function(){(r={}).country_code=TNZ.Cookie.get("COUNTRY_CODE")||"AA",r.session_country_code=TNZ.Cookie.get("SESSION_COUNTRY_CODE")||"AA",r.in_nz="NZ"===r.session_country_code,r.highFidelity=!1,r.latitude=0,r.longitude=0,r.allowFallback=!0,r.sharingEvent="TNZ.GeoLocation.Ready",r.fetchInProgress=!1,TNZ.JSLib.triggerLoadEvent("TNZ.GeoLocation.Loaded")},o.inNZ=function(){var e=o.getSessionCountryCode();return null!=e?"NZ"===e:r.in_nz},o.getCityOID=function(){throw new Error('"getCityOID" function needs to be uncommented. (In geolocation.js)')},o.setCityOID=function(e){throw new Error('"setCityOID" function needs to be uncommented. (In geolocation.js)')},o.getCountryCode=function(){var e=TNZ.Cookie.get("override_X-Country-Code");return null!=e&&e.length?e:r.country_code},o.setCountryCode=function(e){void 0!==e&&TNZ.Cookie.set("override_X-Country-Code",e.toUpperCase(),1)},o.getSessionCountryCode=function(){var e=TNZ.Cookie.get("override_X-Session-Country-Code");return null!=e&&e.length?e:r.session_country_code},o.setSessionCountryCode=function(e){void 0!==e&&TNZ.Cookie.set("override_X-Session-Country-Code",e.toUpperCase(),0)},o.setEndPointHighFidelityURL=function(e){throw new Error('"setEndPointHighFidelityURL" function needs to be uncommented. (In geolocation.js)')},o.getCurrentPosition=function(e,o){return void 0!==e&&(r.sharingEvent+=e),void 0!==o&&(r.allowFallback=o),r.fetchInProgress||(null!=TNZ.Cookie.get("override_X-latitude")?t():0===location.protocol.indexOf("https")||0===location.hostname.indexOf("localhost")?(r.fetchInProgress=!0,navigator.geolocation?navigator.geolocation.getCurrentPosition(n,i):i()):i()),r.sharingEvent},o.setCurrentPosition=function(e,o){void 0!==e.latitude&&void 0!==e.longitude&&(r.highFidelity=o,r.latitude=e.latitude,r.longitude=e.longitude)},o.getBrowserLang=function(){return(navigator.language||navigator.browserLanguage).split("-")[0].toLowerCase()},o.getInternalData=function(){return r},o.init(),o}();