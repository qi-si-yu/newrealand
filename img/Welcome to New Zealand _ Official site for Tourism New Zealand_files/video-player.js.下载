TNZ=window.TNZ||{},TNZ.VideoPlayerHelper=function(){var t={},n={};return t.init=function(e){n.videoPlayerData=e.getData(),n.videoPlayerSettings=e.getSettings(),n.oVideoPlayerPub=e},t.onYouTubeIframeAPIReadyPatternLibrary=function(e,a){var t=document.location.protocol+"//"+document.location.hostname;YT?window.playerPatternLibrary=new YT.Player(e,{videoId:a.id,origin:t,class:"o-player__iframe",width:a.width,height:a.height,host:document.location.protocol+"//www.youtube-nocookie.com",events:{onReady:TNZ.VideoPlayerHelper.onYouTubePlayerReadyPatternLibrary,onStateChange:TNZ.VideoPlayerHelper.onYouTubePlayerStateChangePatternLibrary},playerVars:{autoplay:1,mute:1,modestbranding:1,rel:0,enablejsapi:1,fs:n.videoPlayerSettings.allow_fullscreen?1:0}}):TNZ.EventManager.trigger("TNZ.VideoPlayer.Stop",{settings:n.videoPlayerSettings})},t.onYouTubePlayerReadyPatternLibrary=function(e){TNZ.EventManager.trigger("TNZ.VideoPlayer.PlayerReady-"+n.videoPlayerSettings.block_unique_id,{settings:n.videoPlayerSettings,event:e,videoData:n.videoPlayerData.videoData})},t.onYouTubePlayerStateChangePatternLibrary=function(e){typeof window.onPlayerStateChange==typeof Function&&window.onPlayerStateChange(e),0===e.data&&!0===n.videoPlayerSettings.destroy_at_playend&&n.hasOwnProperty("oVideoPlayerPub")&&typeof n.oVideoPlayerPub.close==typeof Function&&(e.target.destroy(),n.oVideoPlayerPub.close()),TNZ.EventManager.trigger("TNZ.VideoPlayer.YouTubePlayerStateChange-"+n.videoPlayerSettings.block_unique_id,{settings:n.videoPlayerSettings,event:e,videoData:n.videoPlayerData.videoData})},t.onYouKuIframeAPIReadyPatternLibrary=function(e,a){YKU?(window.playerPatternLibrary=new YKU.Player(e,{styleid:"0",client_id:"0edbfd2e4fc91b72",vid:a.id,newPlayer:!0,autoplay:!0,events:{onPlayerReady:function(){TNZ.Util.console.log("Pattern Library: onPlayerReady"),TNZ.VideoPlayerHelper.onYouKuPlayerReadyPatternLibrary()},onPlayStart:function(){TNZ.Util.console.log("Pattern Library: onPlayStart"),window.onPlayStartYouku();TNZ.EventManager.trigger("TNZ.VideoPlayer.YouKuPlayerStateChange-"+n.videoPlayerSettings.block_unique_id,{settings:n.videoPlayerSettings,event:{data:1},videoData:n.videoPlayerData.videoData})},onPlayEnd:function(){TNZ.Util.console.log("Pattern Library: onPlayEnd"),window.onPlayEndYouku();!0===n.videoPlayerSettings.destroy_at_playend&&n.hasOwnProperty("oVideoPlayerPub")&&typeof n.oVideoPlayerPub.close==typeof Function&&n.oVideoPlayerPub.close(),TNZ.EventManager.trigger("TNZ.VideoPlayer.YouKuPlayerStateChange-"+n.videoPlayerSettings.block_unique_id,{settings:n.videoPlayerSettings,event:{data:0},videoData:n.videoPlayerData.videoData})}}}),typeof window.tnzYouKuMessageListenerEvent==typeof Function?window.removeEventListener("message",window.tnzYouKuMessageListenerEvent,!1):window.tnzYouKuMessageListenerEvent=function(e){var a=e.data,t={};switch(a.msg){case"onPlayStart":t={data:1},TNZ.Util.console.log("Pattern Library Desktop:onPlayStart"),window.onPlayStartYouku(),TNZ.EventManager.trigger("TNZ.VideoPlayer.YouKuPlayerStateChange-"+n.videoPlayerSettings.block_unique_id,{settings:n.videoPlayerSettings,event:t,videoData:n.videoPlayerData.videoData});break;case"onPlayEnd":t={data:0},TNZ.Util.console.log("Pattern Library Desktop:onPlayEnd"),window.onPlayEndYouku(),!0===n.videoPlayerSettings.destroy_at_playend&&n.hasOwnProperty("oVideoPlayerPub")&&typeof n.oVideoPlayerPub.close==typeof Function&&n.oVideoPlayerPub.close(),TNZ.EventManager.trigger("TNZ.VideoPlayer.YouKuPlayerStateChange-"+n.videoPlayerSettings.block_unique_id,{settings:n.videoPlayerSettings,event:t,videoData:n.videoPlayerData.videoData});break;case"state":var o={pause:2,play:1},i=a.stateParam;o.hasOwnProperty(i)&&(t={data:o[i]},TNZ.EventManager.trigger("TNZ.VideoPlayer.YouKuPlayerStateChange-"+n.videoPlayerSettings.block_unique_id,{settings:n.videoPlayerSettings,event:t,videoData:n.videoPlayerData.videoData})),TNZ.Util.console.log("Pattern Library Desktop:state",i)}},window.addEventListener("message",window.tnzYouKuMessageListenerEvent,!1),t.onYouKuPlayerReadyPatternLibrary=function(){TNZ.EventManager.trigger("TNZ.VideoPlayer.PlayerReady-"+n.videoPlayerSettings.block_unique_id,{settings:n.videoPlayerSettings,event:{},videoData:n.videoPlayerData.videoData})}):TNZ.EventManager.trigger("TNZ.VideoPlayer.Stop",{settings:n.videoPlayerSettings})},t}(),TNZ.VideoPlayer=function(o,l){if(o=o||{block_unique_id:-1,destroy_at_playend:!1,media_object:null,media_object_type:null,auto_play:!1,allow_fullscreen:!0},l=l||jQuery,!1==!!o.block_unique_id)throw new Error('Settings param "block_unique_id" is required.');if(null!=o.destroy_at_playend&&typeof o.destroy_at_playend==typeof!0!=!1||(o.destroy_at_playend=!1),null!=o.auto_play&&typeof o.auto_play==typeof!0!=!1||(o.auto_play=!1),null!=o.allow_fullscreen&&typeof o.allow_fullscreen==typeof!0!=!1||(o.allow_fullscreen=!0),!1==!!o.media_object&&(o.media_object=null),!0==!!o.media_object&&(!1==!!o.media_object_type||-1===["carousel","mediawall"].indexOf(o.media_object_type)))throw new Error('Settings param "media_object_type" is required if passing an object reference in "media_object" and\ncan currently only be the values of "carousel" OR "mediawall".');var t={},u={};u.$block=l("#"+o.block_unique_id),u.classname="o-player",u.playerClass=".js-player",u.playbtnClass=".js-player-play",u.closebtnClass=".js-player-close",u.attrDataVideoIDName="video-id",u.attrDataLanguageCaptionName="caption-language",u.attrDataVideoProviderName="video-provider",u.facebookDivID="fb-root",u.videoData=null,u.prefixVideoWrapperID="js-videowrapper-"+o.block_unique_id,u.prefixIFrameID="js-iframe-"+o.block_unique_id,u.mediaObjectRefSettings={},!0==!!o.media_object&&(u.mediaObjectRefSettings=o.media_object.getSettings(),"carousel"===o.media_object_type&&!1===u.mediaObjectRefSettings.ismulti&&u.mediaObjectRefSettings.auto_play_video&&(o.auto_play=!0),"mediawall"===o.media_object_type&&u.mediaObjectRefSettings.auto_play_video&&(o.auto_play=!0));function y(e){l("#"+u.prefixVideoWrapperID).append(e)}t.getVideoPlayer=function(){return u.$block.find(u.playbtnClass).closest(u.playerClass)},t.getVideoData=function(){return u.videoData},t.getData=function(){return u},t.getSettings=function(){return o},t.close=function(){s()};function i(e){if("undefined"!=typeof FB&&null!=FB){var t="fb-video-player"+e.id,a=Math.round(e.height*(16/9)),o='<div id="'+t+'" class="fb-video" data-href="https://www.facebook.com/facebook/videos/'+e.id+'" data-width="'+e.width+'" data-allowfullscreen="true" data-autoplay="true" style="width: '+a+'px; margin: 0 auto;"></div>';y(o);var i=function(e){if("video"===e.type&&e.id===t){var a=e.instance.play();void 0!==a&&a.then(function(){FB.Event.unsubscribe("xfbml.ready",i)}).catch(function(e){})}};setTimeout(function(){FB.XFBML.parse(document.getElementById("#"+u.prefixVideoWrapperID)),FB.Event.subscribe("xfbml.ready",i)},200)}else{var n="https://www.facebook.com/video/embed?video_id="+e.id+"&autoplay=true",r=u.prefixIFrameID,d=l("<iframe />").addClass(u.classname+"__iframe").attr("id",r).attr("width",e.width).attr("height",e.height).attr("src",n);y(d)}}function n(){return document.getElementById(u.facebookDivID)}function r(){!function(){var e=document.body;if(!1==!!n()&&!0==!!e){var a=document.createElement("div"),t=document.createAttribute("id");t.value=u.facebookDivID,a.setAttributeNode(t),e.insertBefore(a,e.firstChild)}}();var e=document.body,a=document.createElement("script"),t=document.createTextNode('(function(d, s, id) {var js, fjs = d.getElementsByTagName(s)[0];if (d.getElementById(id)) return;js = d.createElement(s); js.id = id;js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.6";fjs.parentNode.insertBefore(js, fjs);}(document, "script", "facebook-jssdk"));');a.appendChild(t),e.insertBefore(a,e.childNodes[1])}function a(e){!function(e){if(!1==!!e||0===e.length)e=t.getVideoPlayer();var a=null;e&&e.length&&((a={id:e.data(u.attrDataVideoIDName),videoProvider:e.data(u.attrDataVideoProviderName),caption:e.data(u.attrDataLanguageCaptionName),width:e.width(),height:e.height()}).videoId=a.id),u.videoData=a}(e);var a=t.getVideoData();switch(e.data(u.attrDataVideoProviderName)){case"youku":TNZ.VideoPlayerHelper.init(t),function(e){u.prefixIFrameID;var a=u.prefixIFrameID,t=e,o='<div id="'+a+'" class="'+u.classname+'__iframe"/>';y(o),!1===window.hasOwnProperty("onYouKuAPILoaded")||!1===window.onYouKuAPILoaded?(TNZ.Util.console.log("player.youku.com/jsapi : loadScript : ",a,t),TNZ.JSLib.loadScript("//player.youku.com/jsapi","player.youku.com/jsapi")):("function"==typeof window.youkuRetrieveVideoInfo&&window.youkuRetrieveVideoInfo(t.id),TNZ.Util.console.log("player.youku.com/jsapi : ALREADY IN PAGE SO RUN : onYouKuIframeAPIReadyPatternLibrary",a,t),TNZ.VideoPlayerHelper.onYouKuIframeAPIReadyPatternLibrary(a,t)),!1!==window.hasOwnProperty("onYouKuAPILoaded")&&!1!==window.onYouKuAPILoaded||TNZ.JSLib.requireLoadEvent(["player.youku.com/jsapi","docready"],function(){window.onYouKuAPILoaded=!0,"function"==typeof window.youkuRetrieveVideoInfo&&window.youkuRetrieveVideoInfo(t.id),TNZ.Util.console.log("player.youku.com/jsapi : run : onYouKuIframeAPIReadyPatternLibrary",a,t),TNZ.VideoPlayerHelper.onYouKuIframeAPIReadyPatternLibrary(a,t)})}(a);break;case"vimeo":!function(e){var a=u.prefixIFrameID,t="//player.vimeo.com/video/"+e.id+"?autoplay=1&title=0&byline=0&portrait=0&api=1&muted=1&dnt=1&player_id="+a,o=l("<iframe />").addClass(u.classname+"__iframe").attr("id",a).attr("width",e.width).attr("height",e.height).attr("src",t);y(o)}(a);break;case"facebook":n()?i(a):(r(),setTimeout(function(){i(a)},500));break;case"youtube":default:TNZ.VideoPlayerHelper.init(t),function(e){var a=u.prefixIFrameID,t=e,o='<div id="'+a+'" class="'+u.classname+'__iframe"/>';if(y(o),TNZ.EventManager.unbind("TNZ.VideoPlayer.YouTubeAPILoaded"),TNZ.EventManager.bind("TNZ.VideoPlayer.YouTubeAPILoaded",function(e){window.hasOwnProperty("onYouTubeIframeAPIReadyFunctionFired")&&!0===window.onYouTubeIframeAPIReadyFunctionFired&&TNZ.VideoPlayerHelper.onYouTubeIframeAPIReadyPatternLibrary(a,t)}),!1==!!document.getElementById("youtube-api")){var i=document.createElement("script");i.id="youtube-api",i.src="https://www.youtube.com/iframe_api";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(i,n)}typeof window.onYouTubeIframeAPIReady!=typeof Function?(TNZ.Util.console.log("========= window.onYouTubeIframeAPIReady DOES NOT EXIST So create it and trigger event  ===="),window.onYouTubeIframeAPIReady=function(){window.onYouTubeIframeAPIReadyFunctionFired=!0,TNZ.VideoPlayerHelper.onYouTubeIframeAPIReadyPatternLibrary(a,t)}):window.hasOwnProperty("onYouTubeIframeAPIReadyFunctionFired")&&!0===window.onYouTubeIframeAPIReadyFunctionFired&&(TNZ.EventManager.unbind("TNZ.VideoPlayer.YouTubeAPILoaded"),TNZ.VideoPlayerHelper.onYouTubeIframeAPIReadyPatternLibrary(a,t))}(a)}u.$block.find(u.closebtnClass).attr("hidden",!1),TNZ.EventManager.trigger("tnz.carousel.hidetitle-"+o.block_unique_id,{block_unique_id:o.block_unique_id}),TNZ.EventManager.trigger("tnz.carousel.hidetitle",{block_unique_id:o.block_unique_id})}function d(e){!function(e){var a=l("<div />").attr("id",u.prefixVideoWrapperID).addClass(u.classname+"__wrapper");e.append(a)}(e),a(e)}var s=function(){u.$block.find(u.closebtnClass).attr("hidden",!0),l("#"+u.prefixVideoWrapperID).remove(),TNZ.EventManager.trigger("tnz.carousel.showtitle-"+o.block_unique_id,{block_unique_id:o.block_unique_id}),TNZ.EventManager.trigger("tnz.carousel.showtitle",{block_unique_id:o.block_unique_id})};return 1==!!o.media_object&&-1!=["carousel","mediawall"].indexOf(o.media_object_type)&&TNZ.EventManager.bind("TNZ.VideoPlayer.Play-"+u.mediaObjectRefSettings.block_unique_id,function(e){if(TNZ.EventManager.trigger("TNZ.VideoPlayer.Stop",{block_unique_id:o.block_unique_id}),o.auto_play){var a=u.$block.find(u.playbtnClass).closest(u.playerClass);d(a)}}),1==!!o.media_object&&"mediawall"===o.media_object_type&&TNZ.EventManager.bind("TNZ.Mediawall.CloseVideo-"+u.mediaObjectRefSettings.block_unique_id,function(e){s()}),u.$block.on("click",u.playbtnClass,function(e){TNZ.EventManager.trigger("TNZ.VideoPlayer.Stop",{block_unique_id:o.block_unique_id}),e.preventDefault();var a=l(this).closest(u.playerClass),t=a.data();d(a),TNZ.EventManager.trigger("TNZ.VideoPlayer.PlayButtonClicked-"+o.block_unique_id,{block_unique_id:o.block_unique_id,videoData:t})}),u.$block.on("click",u.closebtnClass,function(e){e.preventDefault(),s()}),TNZ.EventManager.bind("TNZ.VideoPlayer.Stop",function(e){s()}),t};